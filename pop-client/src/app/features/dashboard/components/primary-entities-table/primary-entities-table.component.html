
@let entityStatistics = entityStatistics$ | async;
@if (entityStatistics) {
    <p-table 
        [value]="entityStatistics"                                                    
        [paginator]="true"
        [rows]="8">
        <ng-template #header>
            <tr>
                <th>Primary site</th>
                <th>Cases</th>
                <th>Completion</th>
                <th>Contributors</th>
            </tr>
        </ng-template>
        <ng-template #body let-entity>
            <tr>
                <td class="flex">
                    <pop-cancer-icon [topography]="entity.topographyCode"/>
                    <div class="ml-3 my-auto">{{ entity.topographyGroup }}</div>
                </td>
                <td> 
                    <span class="font-semibold">{{ entity.population }}</span>
                </td>
                <td>
                    <p-rating title="{{entity.dataCompletionMedian}}% median completion" [ngModel]="entity.dataCompletionMedian/20" [readonly]="true" />
                </td>
                <td>
                    <p-avatar-group>
                        @for (contributorUsername of entity.contributors; track $index; let index = $index;) {
                            @if (index<3) {
                                @let contributor = contributorUsername | getUser | async;
                                @if (contributor) {
                                    <pop-user-badge [user]="contributor"/>
                                } @else {
                                    <p-skeleton shape="circle" size="2rem"/>
                                }
                            }
                        }
                        @if (entity.contributors.length>3) {
                            <p-avatar [label]="'+' + (entity.contributors.length-3).toString()" shape="circle" size="normal" />
                        }
                    </p-avatar-group>
                </td>
            </tr>
        </ng-template>
    </p-table>
} @else {
    <p-table 
        [value]="[1,2,3,4,5,6,7,8]"                                                    
        [paginator]="true"
        [rows]="8">
        <ng-template #header>
            <tr>
                <th>Entity</th>
                <th>Cases</th>
                <th>Completion</th>
                <th>Contributors</th>
            </tr>
        </ng-template>
        <ng-template #body let-entity>
            <tr>
                <td><p-skeleton /></td>
                <td><p-skeleton /></td>
                <td><p-skeleton /></td>
                <td><p-skeleton /></td>
            </tr>
        </ng-template>
    </p-table>
}