<p-fluid>
    <form  [formGroup]="form" (ngSubmit)="onSave()">

        <div class="field">
            <label for="date" class="form-label required">Date</label>
            <pop-datepicker 
                formControlName="date"
            />
            <pop-form-control-error controlName="date"></pop-form-control-error>
        </div>

        <div class="field">
            <label class="form-label">Gene panel</label>
            <input type="text" 
                pInputText 
                formControlName="genePanel" 
                placeholder="Enter a value, e.g. FoundationOneCDx"
                />           
            <small class="help-text">Commercial or official name of the gene panel used in the test to detect this variant.</small>
            <pop-form-control-error controlName="genePanel"></pop-form-control-error>
        </div>

        <div class="field">
            <label class="form-label">Analysis method</label>
            <pop-concept-selector 
                formControlName="analysisMethod"
                terminology="StructuralVariantAnalysisMethod"
                [showSynonyms]="false"/>
            <small class="help-text">Analysis method used to detect the variant"</small>
            <pop-form-control-error controlName="analysisMethod"></pop-form-control-error>
        </div>

        <div class="field">
            <label class="form-label">Assessment</label>
            <pop-radio-select  
                formControlName="assessment"
                [choices]="assessmentChoices"
                class="flex flex-wrap gap-4"/>
            <small class="help-text">Classification of whether the variant is present or absent in the analysis results. Relevant for genomic studies that report presence and absence of variants.</small>
            <pop-form-control-error controlName="assessment"></pop-form-control-error>
        </div>

        <div class="field">
            <label class="form-label">Confidence</label>
            <pop-radio-select  
                formControlName="confidence"
                [choices]="confidenceChoices"
                class="flex flex-wrap gap-4"/>
            <small class="help-text">Classification of the confidence for a true positive variant call based e.g. calling thresholds or phred-scaled confidence scores.</small>
            <pop-form-control-error controlName="confidence"></pop-form-control-error>
        </div>

        <div class="field">
            <label class="form-label">Clinical relevance</label>
            <p-select 
                formControlName="clinicalRelevance" 
                [options]="clinicalRelevanceChoices" 
                optionLabel="name" 
                optionValue="value" 
                placeholder="Select an option" 
                appendTo="body" 
                />
            <small class="help-text">Classification of the clinical relevance or pathogenicity of the variant.</small>
            <pop-form-control-error controlName="clinicalRelevance"></pop-form-control-error>
        </div>


        <p-fieldset legend="Variant description">

            <div class="field">
                <label class="form-label">Gene(s) affected</label>
                <pop-concept-selector 
                    formControlName="genes"
                    terminology="Gene"
                    [showSynonyms]="true"
                    [multiple]="true"/>
                <small class="help-text">Gene(s) affected by this variant.</small>
                <pop-form-control-error controlName="genes"></pop-form-control-error>
            </div>

            <p-divider></p-divider>

            <label class="form-label">HGVS Annotation</label>

            <div class="field text-muted mt-2">
                <p>
                    <small>
                        The variant must be at-least described at DNA-level using a HGVS expression. Description at RNA- and protein-level is optional and will 
                        provide additional information about the upstream consequences of the variant.
                        For the HGVS nomenclature, please refer to the <a href="https://hgvs-nomenclature.org/stable/" target="_blank">HGVS nomenclature specification</a>
                    </small>
                </p>
            </div>

            <div class="field">
                <label class="form-label">Genomic DNA-level description</label>
                <input type="text" 
                    pInputText 
                    formControlName="genomicHgvs" 
                    placeholder="Enter a value, e.g. NC_005228.5:c.1239283C>T"
                    />                      
                <small class="help-text">Description of the genomic DNA sequence change using a valid HGVS-formatted expression</small>
                <pop-form-control-error controlName="genomicHgvs"></pop-form-control-error>
            </div>

            <div class="field">
                <label class="form-label">Coding DNA-level description</label>
                <input type="text" 
                    pInputText 
                    formControlName="dnaHgvs" 
                    placeholder="Enter a value, e.g. NM_005228.5:c.2369C>T"
                    />                      
                <small class="help-text">Description of the coding DNA sequence change using a valid HGVS-formatted expression</small>
                <pop-form-control-error controlName="dnaHgvs"></pop-form-control-error>
            </div>

            <div class="field">
                <label class="form-label">RNA-level description</label>
                <input type="text" 
                    pInputText 
                    formControlName="rnaHgvs" 
                    placeholder="Enter a value, e.g. NM_000050.2:r.2369c>t"
                    />                      
                <small class="help-text">Description of the RNA sequence change using a valid HGVS-formatted expression</small>
                <pop-form-control-error controlName="rnaHgvs"></pop-form-control-error>
            </div>

            <div class="field">
                <label class="form-label">Protein-level description</label>
                <input type="text" 
                    pInputText 
                    formControlName="proteinHgvs" 
                    placeholder="Enter a value, e.g. NP_000050.2:p.(Asn1836Lys)"
                    />                      
                <small class="help-text">Description of the protein (aminoacid) sequence change using a valid HGVS-formatted expression</small>
                <pop-form-control-error controlName="proteinHgvs"></pop-form-control-error>
            </div>

            <p-divider></p-divider>
    
            <div class="field">
                <label class="form-label">Copy number</label>
                <p-inputnumber 
                    formControlName="copyNumber" 
                    placeholder="Enter a value, e.g. 2"
                    [min]="0"/>
                <small class="help-text">Genomic structural variant copy number. It is a unit-less value. Note that a copy number of 1 can imply a deletion.</small>
                <pop-form-control-error controlName="copyNumber"></pop-form-control-error>
            </div>

            <div class="field">
                <label class="form-label">Molecular Consequence</label>
                <pop-concept-selector 
                    formControlName="molecularConsequence"
                    terminology="MolecularConsequence"
                    [showSynonyms]="true"/>
                <small class="help-text">The calculated or observed effect of a variant on its downstream transcript and, if applicable, ensuing protein sequence.</small>
                <pop-form-control-error controlName="molecularConsequence"></pop-form-control-error>
            </div>
        </p-fieldset>
        

        <p-fieldset legend="Context">
            <div class="field">
                <label class="form-label">Allele frequency</label>
                <p-inputnumber 
                    formControlName="alleleFrequency" 
                    mode="decimal" 
                    placeholder="Enter a value, e.g. 0.75"
                    [min]="0" 
                    [max]="1"/>
                <small class="help-text">The relative frequency (value in range [0,1]) of the allele at a given locus in the sample.</small>
                <pop-form-control-error controlName="alleleFrequency"></pop-form-control-error>
            </div>

            <div class="field">
                <label class="form-label">Allele read depth</label>
                <p-inputnumber 
                    formControlName="alleleDepth" 
                    placeholder="Enter a value, e.g. 275"
                    [min]="0"/>
                <small class="help-text">Specifies the number of reads that identified the allele in question whether it consists of one or a small sequence of contiguous nucleotides.</small>
                <pop-form-control-error controlName="alleleDepth"></pop-form-control-error>
            </div>
            
            <div class="field">
                <label class="form-label">Zygosity</label>
                <pop-concept-selector 
                    formControlName="zygosity"
                    terminology="Zygosity"
                    [showSynonyms]="true"/>
                <small class="help-text">The observed level of occurrence of the variant in the set of chromosomes.</small>
                <pop-form-control-error controlName="zygosity"></pop-form-control-error>
            </div>
            
            <div class="field">
                <label class="form-label">Inheritance</label>
                <pop-concept-selector 
                    formControlName="inheritance"
                    terminology="VariantInheritance"
                    [showSynonyms]="true"/>
                <small class="help-text">Variant inheritance origin (if known).</small>
                <pop-form-control-error controlName="inheritance"></pop-form-control-error>
            </div>

            <div class="field">
                <label class="form-label">ClinVar Identifier</label>
                <input type="text" 
                    pInputText 
                    formControlName="clinvar" 
                    placeholder="Enter a value, e.g. VCV000016613.35"
                    />     
                <small class="help-text">Accession number in the ClinVar variant database, for cross-reference.</small>
                <pop-form-control-error controlName="clinvar"></pop-form-control-error>
            </div>
        </p-fieldset>


        <p-button 
            type="submit" 
            label="Save" 
            styleClass="w-full p-3 mt-2"  
            [loading]="loading"
            [disabled]="form.invalid" />
            
    </form>
</p-fluid>