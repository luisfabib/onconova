<div class="card">
    <p-iconField iconPosition="left">
        <p-inputIcon styleClass="pi pi-search" />
        <input type="text" pInputText placeholder="Search" [(ngModel)]="filterValue" (ngModelChange)="filterPatients(filterValue)"/>
    </p-iconField>
    <p-button (onClick)="showDialog()" label="New case" class="ml-3"></p-button>

</div>
        <p-dataView #dv [value]="filteredPatients" [paginator]="true" [rows]="10" *ngIf="!loading" >
        <ng-template pTemplate="list" let-patients>
            <div class="grid grid-nogutter">
                <div class="col-12" *ngFor="let patient of patients; let first = first" class="col-12">
                    <div class="card flex flex-column sm:flex-row sm:align-items-center p-4 gap-3 mb-3" [ngClass]="{ 'border-top-1 surface-border': !first }">
                        <p-avatar size="xlarge" [style]="{'background': 'white', 'border': '1px solid #f0f2'}">
                            <svg width="4rem" height="4rem" [data-jdenticon-value]="[patient.pseudoidentifier]"></svg>
                        </p-avatar>


                        <div class="flex flex-column">
                            <div class="text-xl font-bold">{{patient.pseudoidentifier}}</div>
                            <div class="">
                                <i class="pi pi-mars"></i>,
                                {{patient.birthdate}}  
                                <span *ngIf="patient.is_deceased">, â€ </span></div>
                        </div>
                    </div>
                </div>
            </div>
        </ng-template>
    </p-dataView>

    <!-- Skeleton loader -->
    <div *ngIf="loading">
        <div *ngFor="let i of [1, 2, 3, 4, 5, 6, 7, 8]; let first = first">
            <div class="flex flex-row  p-4 gap-3" [ngClass]="{ 'border-top-1 surface-border': !first }">
                <p-skeleton [style]="{ width: '4rem', height: '4rem'}"></p-skeleton>
                <div class="flex flex-column">
                    <p-skeleton class="mb-2 mt-3" [style]="{ width: '10rem', height: '1rem'}"></p-skeleton>    
                    <p-skeleton [style]="{ width: '20rem', height: '1rem' }"></p-skeleton>      
                </div>
            </div>
        </div>
</div>


<p-dialog 
    header="Header" 
    [(visible)]="patientFormVisible" 
    [modal]="true" 
    [style]="{ width: '50rem', height: '50rem' }">
        <ng-template pTemplate="header">
            <div class="inline-flex align-items-center justify-content-center gap-2">
                <p-avatar 
                    image="https://primefaces.org/cdn/primeng/images/demo/avatar/amyelsner.png" 
                    shape="circle" />
                <span class="font-bold white-space-nowrap">
                    Amy Elsner
                </span>
            </div>
        </ng-template>
        <patient-form></patient-form>
        <ng-template pTemplate="footer">
            <p-button 
                label="Cancel" 
                [text]="true" 
                severity="secondary" 
                (onClick)="patientFormVisible = false" />
            <p-button 
                label="Save" 
                [outlined]="true" 
                severity="secondary" 
                (onClick)="patientFormVisible = false" 
              />
        </ng-template>
</p-dialog>