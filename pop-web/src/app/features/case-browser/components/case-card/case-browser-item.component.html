
<div 
    class="case-browser-card card flex flex-column sm:flex-row sm:align-items-center p-3 gap-3 mb-3" 
    [routerLink]="['/cases', case.pseudoidentifier]" 
    target="_blank">
    
    <!-- Identicon -->
    <p-avatar size="xlarge" [style]="{'background': 'none', 'border': 'none', 'padding': '0'}">
        <svg class="jdenticon" width="4rem" height="4rem" [data-jdenticon-value]="[case.pseudoidentifier]"></svg>
    </p-avatar>

    <div class="flex flex-column" style="width: 10%">
        <div class="text-xl mb-1 font-bold" style="font-family: monospace;">{{case.pseudoidentifier}}</div>
        <div class="flex">
            {{ case.gender.display }}, {{case.age}} years 
            <span *ngIf="case.isDeceased">, â€ </span>
        </div>
    </div>

    <p-divider layout="vertical" />

    <div class="flex flex-column" style="width: 20%">
        <ng-container *ngIf="primaryEntity$ | async as primaryEntity; else pending">
            <div class="flex gap-2">
                <cancer-icon [topography]="primaryEntity.topography.code"></cancer-icon>
                <div class="my-auto">{{ primaryEntity.description }}</div>
            </div>
        </ng-container>
        <ng-template #pending>
            <div>Diagnosis pending</div>
            <div>No further information available</div>
        </ng-template>
    </div>

    <p-divider layout="vertical"/>

    <div class="flex flex-column text-center gap-3" >
        Created
        <div class="">{{ case.createdAt | date }}</div>
    </div>
    <div class="flex flex-column text-center gap-2" *ngIf="this.case.createdById" >
        Manager
        <ng-container *ngIf="createdByUsername$ | async as username">
            <p-avatar 
                label="{{ username[0].toUpperCase() }}" 
                size="normal" 
                [style]="{ 'background-color': '#dee9fc', color: '#1a2551' }"
                title="{{ username }}" 
                shape="circle"/>
        </ng-container>
    </div>
    <div class="flex flex-column text-center gap-2"> 
        Contributors
        <p-avatarGroup styleClass="my-auto">
            <ng-container *ngFor="let username$ of updatedByUsernames$;">
                <ng-container *ngIf="username$ | async as username">
                    <p-avatar 
                    label="{{ username[0].toUpperCase() }}" 
                    size="normal" 
                    shape="circle"
                    [style]="{ 'background-color': '#dee9fc', color: '#1a2551' }"
                    title="{{ username }}" 
                    />
                </ng-container>
            </ng-container>
            <p-avatar *ngIf="case.updatedByIds && case.updatedByIds.length > 2"
                label="+2" 
                shape="circle"
                size="normal" 
                [style]="{ 'background-color': 'grey', color: '#ffffff' }" />
        </p-avatarGroup> 
    </div>
</div>
