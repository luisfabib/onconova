# Generated by Django 5.1 on 2025-07-07 09:03

import pgtrigger.compiler
import pgtrigger.migrations
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('oncology', '0015_remove_radiotherapy_create_insert_and_more'),
    ]

    operations = [
        pgtrigger.migrations.RemoveTrigger(
            model_name='genomicvariant',
            name='create_insert',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='genomicvariant',
            name='update_update',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='genomicvariant',
            name='delete_delete',
        ),
        migrations.AddField(
            model_name='genomicvariant',
            name='assessment_date',
            field=models.DateField(blank=True, help_text='Date at which the genomic variant was assessed and/or reported.', null=True, verbose_name='Assessment date'),
        ),
        migrations.AddField(
            model_name='genomicvariantevent',
            name='assessment_date',
            field=models.DateField(blank=True, help_text='Date at which the genomic variant was assessed and/or reported.', null=True, verbose_name='Assessment date'),
        ),
        migrations.AlterField(
            model_name='genomicvariant',
            name='date',
            field=models.DateField(help_text='Clinically-relevant date of the genomic variant (e.g. the specimen collection date).', verbose_name='Date'),
        ),
        migrations.AlterField(
            model_name='genomicvariantevent',
            name='date',
            field=models.DateField(help_text='Clinically-relevant date of the genomic variant (e.g. the specimen collection date).', verbose_name='Date'),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='genomicvariant',
            trigger=pgtrigger.compiler.Trigger(name='create_insert', sql=pgtrigger.compiler.UpsertTriggerSql(func='INSERT INTO "oncology_genomicvariantevent" ("allele_depth", "allele_frequency", "analysis_method_id", "assessment", "assessment_date", "case_id", "clinical_relevance", "clinvar", "confidence", "coordinate_system_id", "copy_number", "date", "dna_hgvs", "external_source", "external_source_id", "gene_panel", "genome_assembly_version_id", "id", "inheritance_id", "molecular_consequence_id", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "protein_hgvs", "rna_hgvs", "zygosity_id") VALUES (NEW."allele_depth", NEW."allele_frequency", NEW."analysis_method_id", NEW."assessment", NEW."assessment_date", NEW."case_id", NEW."clinical_relevance", NEW."clinvar", NEW."confidence", NEW."coordinate_system_id", NEW."copy_number", NEW."date", NEW."dna_hgvs", NEW."external_source", NEW."external_source_id", NEW."gene_panel", NEW."genome_assembly_version_id", NEW."id", NEW."inheritance_id", NEW."molecular_consequence_id", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'create\', NEW."id", NEW."protein_hgvs", NEW."rna_hgvs", NEW."zygosity_id"); RETURN NULL;', hash='9764e6ce4c19e77ff2153700952cfe746e42cafe', operation='INSERT', pgid='pgtrigger_create_insert_9a498', table='oncology_genomicvariant', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='genomicvariant',
            trigger=pgtrigger.compiler.Trigger(name='update_update', sql=pgtrigger.compiler.UpsertTriggerSql(condition='WHEN (OLD.* IS DISTINCT FROM NEW.*)', func='INSERT INTO "oncology_genomicvariantevent" ("allele_depth", "allele_frequency", "analysis_method_id", "assessment", "assessment_date", "case_id", "clinical_relevance", "clinvar", "confidence", "coordinate_system_id", "copy_number", "date", "dna_hgvs", "external_source", "external_source_id", "gene_panel", "genome_assembly_version_id", "id", "inheritance_id", "molecular_consequence_id", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "protein_hgvs", "rna_hgvs", "zygosity_id") VALUES (NEW."allele_depth", NEW."allele_frequency", NEW."analysis_method_id", NEW."assessment", NEW."assessment_date", NEW."case_id", NEW."clinical_relevance", NEW."clinvar", NEW."confidence", NEW."coordinate_system_id", NEW."copy_number", NEW."date", NEW."dna_hgvs", NEW."external_source", NEW."external_source_id", NEW."gene_panel", NEW."genome_assembly_version_id", NEW."id", NEW."inheritance_id", NEW."molecular_consequence_id", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'update\', NEW."id", NEW."protein_hgvs", NEW."rna_hgvs", NEW."zygosity_id"); RETURN NULL;', hash='da65f3d280fed2f57b072da0a9d5582dbdaae724', operation='UPDATE', pgid='pgtrigger_update_update_5a801', table='oncology_genomicvariant', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='genomicvariant',
            trigger=pgtrigger.compiler.Trigger(name='delete_delete', sql=pgtrigger.compiler.UpsertTriggerSql(func='INSERT INTO "oncology_genomicvariantevent" ("allele_depth", "allele_frequency", "analysis_method_id", "assessment", "assessment_date", "case_id", "clinical_relevance", "clinvar", "confidence", "coordinate_system_id", "copy_number", "date", "dna_hgvs", "external_source", "external_source_id", "gene_panel", "genome_assembly_version_id", "id", "inheritance_id", "molecular_consequence_id", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "protein_hgvs", "rna_hgvs", "zygosity_id") VALUES (OLD."allele_depth", OLD."allele_frequency", OLD."analysis_method_id", OLD."assessment", OLD."assessment_date", OLD."case_id", OLD."clinical_relevance", OLD."clinvar", OLD."confidence", OLD."coordinate_system_id", OLD."copy_number", OLD."date", OLD."dna_hgvs", OLD."external_source", OLD."external_source_id", OLD."gene_panel", OLD."genome_assembly_version_id", OLD."id", OLD."inheritance_id", OLD."molecular_consequence_id", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'delete\', OLD."id", OLD."protein_hgvs", OLD."rna_hgvs", OLD."zygosity_id"); RETURN NULL;', hash='58b10a4fd49e29d541533a441c46fa4d22582bae', operation='DELETE', pgid='pgtrigger_delete_delete_43385', table='oncology_genomicvariant', when='AFTER')),
        ),
    ]
