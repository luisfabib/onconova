# Generated by Django 5.1 on 2024-12-11 14:05

from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('oncology', '0005_tumormarker_arbitrary_concentration_and_more'),
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.AddField(
            model_name='tumormarker',
            name='classification',
            field=models.CharField(blank=True, choices=[('positive', 'Positive'), ('negative', 'Negative'), ('indeterminate', 'Indeterminate'), ('intact', 'Intact'), ('loss', 'Loss'), ('indeterminate', 'Indeterminate'), ('IC0', 'IC0'), ('IC1', 'IC1'), ('IC2', 'IC2'), ('IC3', 'IC3'), ('TC0', 'TC0'), ('TC1', 'TC1'), ('TC2', 'TC2'), ('TC3', 'TC3'), ('0', '0'), ('1+', '1+'), ('2+', '2+'), ('3+', '3+'), ('indeterminate', 'Indeterminate')], help_text='Qualitative classification of the analyte', max_length=50, null=True, verbose_name='Classification'),
        ),
        migrations.AddConstraint(
            model_name='tumormarker',
            constraint=models.CheckConstraint(condition=models.Q(('mass_concentration__isnull', False), ('arbitrary_concentration__isnull', False), ('substance_concentration__isnull', False), ('fraction__isnull', False), ('multiple_of_median__isnull', False), ('classification__isnull', False), _connector='OR'), name='tumor marker must at least have one value'),
        ),
        migrations.AddConstraint(
            model_name='tumormarker',
            constraint=models.CheckConstraint(condition=models.Q(models.Q(('analyte', 'PD-L1 ICS'), _negated=True), models.Q(('analyte', 'PD-L1 ICS'), ('classification__in', [('IC0', 'IC0'), ('IC1', 'IC1'), ('IC2', 'IC2'), ('IC3', 'IC3')])), _connector='OR'), name='PD-L1 ICS can only have ICS classification'),
        ),
        migrations.AddConstraint(
            model_name='tumormarker',
            constraint=models.CheckConstraint(condition=models.Q(models.Q(('analyte', 'PD-L1 TPS'), _negated=True), models.Q(('analyte', 'PD-L1 TPS'), ('classification__in', [('TC0', 'TC0'), ('TC1', 'TC1'), ('TC2', 'TC2'), ('TC3', 'TC3')])), _connector='OR'), name='PD-L1 TPS can only have TPS classification'),
        ),
    ]
