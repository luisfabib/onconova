# Generated by Django 5.1 on 2025-06-11 08:02

import django.db.models.deletion
import pgtrigger.compiler
import pgtrigger.migrations
import uuid
from django.db import migrations, models


class Migration(migrations.Migration):

    dependencies = [
        ('oncology', '0014_remove_radiotherapy_create_insert_and_more'),
    ]

    operations = [
        pgtrigger.migrations.RemoveTrigger(
            model_name='radiotherapy',
            name='create_insert',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='radiotherapy',
            name='update_update',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='radiotherapy',
            name='delete_delete',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='surgery',
            name='create_insert',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='surgery',
            name='update_update',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='surgery',
            name='delete_delete',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='systemictherapy',
            name='create_insert',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='systemictherapy',
            name='update_update',
        ),
        pgtrigger.migrations.RemoveTrigger(
            model_name='systemictherapy',
            name='delete_delete',
        ),
        migrations.AddField(
            model_name='radiotherapyevent',
            name='id',
            field=models.UUIDField(default=uuid.uuid4, editable=False, serialize=False),
        ),
        migrations.AddField(
            model_name='radiotherapyevent',
            name='therapy_line',
            field=models.ForeignKey(blank=True, db_constraint=False, help_text='Therapy line to which the radiotherapy is assigned to', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', related_query_name='+', to='oncology.therapyline', verbose_name='Therapy line'),
        ),
        migrations.AddField(
            model_name='surgeryevent',
            name='id',
            field=models.UUIDField(default=uuid.uuid4, editable=False, serialize=False),
        ),
        migrations.AddField(
            model_name='surgeryevent',
            name='therapy_line',
            field=models.ForeignKey(blank=True, db_constraint=False, help_text='Therapy line to which the surgery is assigned to', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', related_query_name='+', to='oncology.therapyline', verbose_name='Therapy line'),
        ),
        migrations.AddField(
            model_name='systemictherapyevent',
            name='id',
            field=models.UUIDField(default=uuid.uuid4, editable=False, serialize=False),
        ),
        migrations.AddField(
            model_name='systemictherapyevent',
            name='therapy_line',
            field=models.ForeignKey(blank=True, db_constraint=False, help_text='Therapy line to which the systemic therapy is assigned to', null=True, on_delete=django.db.models.deletion.DO_NOTHING, related_name='+', related_query_name='+', to='oncology.therapyline', verbose_name='Therapy line'),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='radiotherapy',
            trigger=pgtrigger.compiler.Trigger(name='create_insert', sql=pgtrigger.compiler.UpsertTriggerSql(func='INSERT INTO "oncology_radiotherapyevent" ("case_id", "external_source", "external_source_id", "id", "intent", "period", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "sessions", "termination_reason_id", "therapy_line_id") VALUES (NEW."case_id", NEW."external_source", NEW."external_source_id", NEW."id", NEW."intent", NEW."period", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'create\', NEW."id", NEW."sessions", NEW."termination_reason_id", NEW."therapy_line_id"); RETURN NULL;', hash='91d7df45f051e30f78777a5715cc7fda9134bbb7', operation='INSERT', pgid='pgtrigger_create_insert_9d3c3', table='oncology_radiotherapy', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='radiotherapy',
            trigger=pgtrigger.compiler.Trigger(name='update_update', sql=pgtrigger.compiler.UpsertTriggerSql(condition='WHEN (OLD.* IS DISTINCT FROM NEW.*)', func='INSERT INTO "oncology_radiotherapyevent" ("case_id", "external_source", "external_source_id", "id", "intent", "period", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "sessions", "termination_reason_id", "therapy_line_id") VALUES (NEW."case_id", NEW."external_source", NEW."external_source_id", NEW."id", NEW."intent", NEW."period", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'update\', NEW."id", NEW."sessions", NEW."termination_reason_id", NEW."therapy_line_id"); RETURN NULL;', hash='6ecc9f19ccca68a1382fe617af91af51bc2f421d', operation='UPDATE', pgid='pgtrigger_update_update_f2cc5', table='oncology_radiotherapy', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='radiotherapy',
            trigger=pgtrigger.compiler.Trigger(name='delete_delete', sql=pgtrigger.compiler.UpsertTriggerSql(func='INSERT INTO "oncology_radiotherapyevent" ("case_id", "external_source", "external_source_id", "id", "intent", "period", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "sessions", "termination_reason_id", "therapy_line_id") VALUES (OLD."case_id", OLD."external_source", OLD."external_source_id", OLD."id", OLD."intent", OLD."period", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'delete\', OLD."id", OLD."sessions", OLD."termination_reason_id", OLD."therapy_line_id"); RETURN NULL;', hash='6c4669c0260845abbee2c654c0315e7e810bacfa', operation='DELETE', pgid='pgtrigger_delete_delete_40b48', table='oncology_radiotherapy', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='surgery',
            trigger=pgtrigger.compiler.Trigger(name='create_insert', sql=pgtrigger.compiler.UpsertTriggerSql(func='INSERT INTO "oncology_surgeryevent" ("bodysite_id", "bodysite_laterality_id", "bodysite_qualifier_id", "case_id", "date", "external_source", "external_source_id", "id", "intent", "outcome_id", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "procedure_id", "therapy_line_id") VALUES (NEW."bodysite_id", NEW."bodysite_laterality_id", NEW."bodysite_qualifier_id", NEW."case_id", NEW."date", NEW."external_source", NEW."external_source_id", NEW."id", NEW."intent", NEW."outcome_id", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'create\', NEW."id", NEW."procedure_id", NEW."therapy_line_id"); RETURN NULL;', hash='88a109c7a0d1e11ae7919a0a81b768bdf7281f0c', operation='INSERT', pgid='pgtrigger_create_insert_e916b', table='oncology_surgery', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='surgery',
            trigger=pgtrigger.compiler.Trigger(name='update_update', sql=pgtrigger.compiler.UpsertTriggerSql(condition='WHEN (OLD.* IS DISTINCT FROM NEW.*)', func='INSERT INTO "oncology_surgeryevent" ("bodysite_id", "bodysite_laterality_id", "bodysite_qualifier_id", "case_id", "date", "external_source", "external_source_id", "id", "intent", "outcome_id", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "procedure_id", "therapy_line_id") VALUES (NEW."bodysite_id", NEW."bodysite_laterality_id", NEW."bodysite_qualifier_id", NEW."case_id", NEW."date", NEW."external_source", NEW."external_source_id", NEW."id", NEW."intent", NEW."outcome_id", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'update\', NEW."id", NEW."procedure_id", NEW."therapy_line_id"); RETURN NULL;', hash='14a2e7ce6cfde1e76d34c3ddd05c031ae58ba944', operation='UPDATE', pgid='pgtrigger_update_update_cf528', table='oncology_surgery', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='surgery',
            trigger=pgtrigger.compiler.Trigger(name='delete_delete', sql=pgtrigger.compiler.UpsertTriggerSql(func='INSERT INTO "oncology_surgeryevent" ("bodysite_id", "bodysite_laterality_id", "bodysite_qualifier_id", "case_id", "date", "external_source", "external_source_id", "id", "intent", "outcome_id", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "procedure_id", "therapy_line_id") VALUES (OLD."bodysite_id", OLD."bodysite_laterality_id", OLD."bodysite_qualifier_id", OLD."case_id", OLD."date", OLD."external_source", OLD."external_source_id", OLD."id", OLD."intent", OLD."outcome_id", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'delete\', OLD."id", OLD."procedure_id", OLD."therapy_line_id"); RETURN NULL;', hash='4dfa96fcec1ef1f82d357749e98e7af3024b8294', operation='DELETE', pgid='pgtrigger_delete_delete_3d1ec', table='oncology_surgery', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='systemictherapy',
            trigger=pgtrigger.compiler.Trigger(name='create_insert', sql=pgtrigger.compiler.UpsertTriggerSql(func='INSERT INTO "oncology_systemictherapyevent" ("adjunctive_role_id", "case_id", "cycles", "external_source", "external_source_id", "id", "intent", "period", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "termination_reason_id", "therapy_line_id") VALUES (NEW."adjunctive_role_id", NEW."case_id", NEW."cycles", NEW."external_source", NEW."external_source_id", NEW."id", NEW."intent", NEW."period", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'create\', NEW."id", NEW."termination_reason_id", NEW."therapy_line_id"); RETURN NULL;', hash='1c9353777c48c95d9acacfbcd59b2be7106d4376', operation='INSERT', pgid='pgtrigger_create_insert_b1c76', table='oncology_systemictherapy', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='systemictherapy',
            trigger=pgtrigger.compiler.Trigger(name='update_update', sql=pgtrigger.compiler.UpsertTriggerSql(condition='WHEN (OLD.* IS DISTINCT FROM NEW.*)', func='INSERT INTO "oncology_systemictherapyevent" ("adjunctive_role_id", "case_id", "cycles", "external_source", "external_source_id", "id", "intent", "period", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "termination_reason_id", "therapy_line_id") VALUES (NEW."adjunctive_role_id", NEW."case_id", NEW."cycles", NEW."external_source", NEW."external_source_id", NEW."id", NEW."intent", NEW."period", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'update\', NEW."id", NEW."termination_reason_id", NEW."therapy_line_id"); RETURN NULL;', hash='c0115e86b87d6fd7838fb5caca1222f9985c72a1', operation='UPDATE', pgid='pgtrigger_update_update_86fe4', table='oncology_systemictherapy', when='AFTER')),
        ),
        pgtrigger.migrations.AddTrigger(
            model_name='systemictherapy',
            trigger=pgtrigger.compiler.Trigger(name='delete_delete', sql=pgtrigger.compiler.UpsertTriggerSql(func='INSERT INTO "oncology_systemictherapyevent" ("adjunctive_role_id", "case_id", "cycles", "external_source", "external_source_id", "id", "intent", "period", "pgh_context", "pgh_context_id", "pgh_created_at", "pgh_label", "pgh_obj_id", "termination_reason_id", "therapy_line_id") VALUES (OLD."adjunctive_role_id", OLD."case_id", OLD."cycles", OLD."external_source", OLD."external_source_id", OLD."id", OLD."intent", OLD."period", COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_metadata\', TRUE), \'\'), NULL)::JSONB, COALESCE(NULLIF(CURRENT_SETTING(\'pghistory.context_id\', TRUE), \'\'), NULL)::UUID, NOW(), \'delete\', OLD."id", OLD."termination_reason_id", OLD."therapy_line_id"); RETURN NULL;', hash='e5713a8fe586a51400cad4a116bc652719a9723e', operation='DELETE', pgid='pgtrigger_delete_delete_7ed74', table='oncology_systemictherapy', when='AFTER')),
        ),
    ]
